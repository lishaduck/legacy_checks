# Dispatched by `tag.yaml`
---
name: Publish

on:
  workflow_dispatch:

defaults:
  run:
    shell: bash

env:
  CI: true

permissions: {}

jobs:
  publish:
    name: Publish
    timeout-minutes: 10
    runs-on: ubuntu-latest

    permissions:
      id-token: write
    environment: publish

    steps:
      - name: ğŸ“š Git checkout
        uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd # v6.0.2
        with:
          submodules: recursive
          clean: true
          persist-credentials: false
          set-safe-directory: true
      - name: ğŸ¦ Set up Flutter
        id: flutter
        uses: subosito/flutter-action@fd55f4c5af5b953cc57a2be44cb082c8f6635e8e # v2.21.0
        with:
          flutter-version-file: pubspec.yaml
          cache: true
      - name: ğŸŒ Disable analytics
        run: flutter --disable-analytics
      - name: ğŸ“¦ Install dependencies
        uses: bluefireteam/melos-action@87341378ab58352c16a285640c414dd60b22353a # v3.5.0
        with:
          melos-version: 7.0.0-dev.8
          dart-version: none
          enforce-lockfile: true
          publish: true
